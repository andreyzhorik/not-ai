<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>NOT AI ‚Äì Chat UI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root {
    --bg: #0a0f1c;
    --panel: #10182a;
    --accent: #3b82f6;
    --accent-soft: #1d4ed8;
    --muted: #94a3b8;
    --text: #e5eaf5;
    --radius: 16px;
    --shadow: 0 10px 30px rgba(0,0,0,0.3);
    font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
  }

  * { box-sizing: border-box; }

  body {
    margin: 0;
    background: linear-gradient(180deg, var(--bg), #060b17);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .app {
    width: 95%;
    max-width: 800px;
    height: 90vh;
    display: flex;
    flex-direction: column;
    background: var(--panel);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.05);
  }

  header {
    padding: 18px 22px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255,255,255,0.02);
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }

  .brand {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .logo {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    background: linear-gradient(135deg, var(--accent), var(--accent-soft));
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 1.1rem;
    color: #fff;
    box-shadow: 0 4px 15px rgba(59,130,246,0.3);
  }

  .title { font-weight: 700; font-size: 1.1rem; color: var(--accent); }
  .subtitle { font-size: 0.85rem; color: var(--muted); }

  .controls { display: flex; align-items: center; gap: 10px; }

  select {
    background: rgba(255,255,255,0.05);
    color: var(--text);
    border: 1px solid rgba(255,255,255,0.1);
    padding: 8px 10px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
  }

  .btn {
    background: var(--accent);
    color: #fff;
    border: none;
    padding: 8px 14px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
  }

  .btn:hover { background: var(--accent-soft); }

  .chat-box {
    flex: 1;
    padding: 22px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .msg {
    max-width: 75%;
    padding: 12px 16px;
    border-radius: 14px;
    line-height: 1.5;
    font-size: 1rem;
    word-wrap: break-word;
    box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  }

  .msg.assistant {
    align-self: flex-start;
    background: #162037;
    color: #e5eaf5;
    border-bottom-left-radius: 6px;
  }

  .msg.user {
    align-self: flex-end;
    background: linear-gradient(135deg, var(--accent-soft), var(--accent));
    color: white;
    border-bottom-right-radius: 6px;
  }

  footer {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 14px;
    background: #0d1525;
    border-top: 1px solid rgba(255,255,255,0.05);
  }

  textarea {
    flex: 1;
    background: #0c1222;
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 10px;
    color: var(--text);
    padding: 12px;
    font-size: 1rem;
    resize: none;
    height: 50px;
    outline: none;
  }

  textarea::placeholder { color: var(--muted); }

  button.send {
    background: var(--accent);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    box-shadow: 0 6px 18px rgba(59,130,246,0.3);
    transition: all 0.2s ease;
  }

  button.send:hover { background: var(--accent-soft); }

  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }

  @media (max-width: 640px) {
    .app { height: 100vh; border-radius: 0; }
    header { padding: 14px; }
    footer { padding: 10px; }
  }
</style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo">N</div>
        <div>
          <div class="title">NOT AI</div>
          <div class="subtitle">Local & Private Chat UI</div>
        </div>
      </div>
      <div class="controls">
        <select id="provider">
          <option value="gpt-4o-mini">GPT-4o Mini (Free)</option>
          <option value="gpt-4o" data-locked="true">GPT-4o (Invite)</option>
          <option value="gpt-5-mini" data-locked="true">GPT-5 Mini (Invite)</option>
          <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
        </select>
        <button class="btn" id="clear">Clear</button>
      </div>
    </header>

    <main class="chat-box" id="chat"></main>

    <footer>
      <textarea id="prompt" placeholder="Type your message..."></textarea>
      <button class="send" id="send">Send</button>
    </footer>
  </div>

  <script>
    const WORKER_URL = "https://plain-pine-b32a.mrviktor2426.workers.dev";
    const INVITE_KEY = "invite_code";

    const chatBox = document.getElementById("chat");
    const sendBtn = document.getElementById("send");
    const promptInput = document.getElementById("prompt");
    const providerSelect = document.getElementById("provider");
    const clearBtn = document.getElementById("clear");

    function addMessage(content, role) {
      const div = document.createElement("div");
      div.className = "msg " + role;
      div.textContent = content;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    clearBtn.onclick = () => { chatBox.innerHTML = ""; };

    providerSelect.addEventListener("change", async () => {
      const selected = providerSelect.selectedOptions[0];
      if (selected.dataset.locked === "true") {
        const saved = localStorage.getItem(INVITE_KEY);
        if (!saved) {
          const code = prompt("üîí This model requires an invite code:");
          if (!code) {
            alert("No code entered ‚Äî reverting to free model.");
            providerSelect.value = "gpt-4o-mini";
            return;
          }
          const res = await fetch(`${WORKER_URL}?verify_code=${code}`);
          const data = await res.json();
          if (data.valid) {
            localStorage.setItem(INVITE_KEY, code);
            alert("‚úÖ Code accepted ‚Äî unlocked!");
          } else {
            alert("‚ùå Invalid invite code.");
            providerSelect.value = "gpt-4o-mini";
          }
        }
      }
    });

    sendBtn.onclick = async () => {
      const text = promptInput.value.trim();
      if (!text) return;
      const provider = providerSelect.value;

      addMessage(text, "user");
      promptInput.value = "";

      try {
        const res = await fetch(WORKER_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            provider,
            messages: [{ role: "user", content: text }],
          }),
        });

        const data = await res.json();
       if (data.error) {
  const errMsg =
    typeof data.error === "string"
      ? data.error
      : JSON.stringify(data.error, null, 2);
  addMessage("‚ùå Error:\n" + errMsg, "assistant");
} else {
  const reply = data.choices?.[0]?.message?.content || "‚ö†Ô∏è No reply";
  addMessage(reply, "assistant");
}

      } catch (err) {
        addMessage("‚ö†Ô∏è Network error: " + err.message, "assistant");
      }
    };
  </script>
</body>
</html>
